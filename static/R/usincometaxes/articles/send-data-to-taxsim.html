<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="usincometaxes">
<title>Manually Upload Data to TAXSIM32 • usincometaxes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Manually Upload Data to TAXSIM32">
<meta property="og:description" content="usincometaxes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">usincometaxes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/using-usincometaxes.html">Calculating Federal and State Income Taxes</a>
    <a class="dropdown-item" href="../articles/taxsim-input.html">Description of Input Columns</a>
    <a class="dropdown-item" href="../articles/taxsim-output.html">Description of Output Columns</a>
    <a class="dropdown-item" href="../articles/send-data-to-taxsim.html">Manually Upload Data to TAXSIM32</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/shanejorr/usincometaxes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Manually Upload Data to TAXSIM32</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/shanejorr/usincometaxes/blob/HEAD/vignettes/send-data-to-taxsim.Rmd" class="external-link"><code>vignettes/send-data-to-taxsim.Rmd</code></a></small>
      <div class="d-none name"><code>send-data-to-taxsim.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shanejorr/usincometaxes" class="external-link">usincometaxes</a></span><span class="op">)</span></code></pre></div>
<p><code>usincometaxes</code> sends data to the National Bureau of Economic Research’s (NBER) <a href="http://taxsim.nber.org/taxsim32/" class="external-link">TAXSIM 32</a> server. The data must meet TAXSIM 32’s requirements for data types and column names. <code>usincometaxes</code> performs checks to ensure the data will be accepted by TAXSIM 32. It’s possible, however, that issues will slip through. This can produce cryptic errors that might be hard to location. If you receive unresolveable errors, it could be helpful to manually upload your data to TAXSIM 32’s servers.</p>
<p><code>usincometaxes</code> provides a function, <code><a href="../reference/create_dataset_for_taxsim.html">create_dataset_for_taxsim()</a></code>, to format your data for manual uploading. To use the function, prepare your dataset as you normally would to use <code><a href="../reference/taxsim_calculate_taxes.html">taxsim_calculate_taxes()</a></code>. For example, follow the formatting required for <a href="https://www.shaneorr.io/r/usincometaxes/articles/taxsim-input.html" class="external-link">input columns</a>. Then, supply the dataset to <code><a href="../reference/create_dataset_for_taxsim.html">create_dataset_for_taxsim()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">taxpayer_finances</span><span class="op">)</span>

<span class="va">taxsim_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dataset_for_taxsim.html">create_dataset_for_taxsim</a></span><span class="op">(</span><span class="va">taxpayer_finances</span><span class="op">)</span>
<span class="co">#&gt; All required columns are present and the data is in the proper format!</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">taxsim_dataset</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="8%">
<col width="4%">
<col width="5%">
<col width="5%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="9%">
<col width="6%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="right">taxsimid</th>
<th align="right">year</th>
<th align="right">mstat</th>
<th align="right">state</th>
<th align="right">page</th>
<th align="right">sage</th>
<th align="right">depx</th>
<th align="right">dep13</th>
<th align="right">dep17</th>
<th align="right">dep18</th>
<th align="right">pwages</th>
<th align="right">swages</th>
<th align="right">dividends</th>
<th align="right">intrec</th>
<th align="right">stcg</th>
<th align="right">ltcg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2000</td>
<td align="right">1</td>
<td align="right">34</td>
<td align="right">35</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">22701</td>
<td align="right">0</td>
<td align="right">6658</td>
<td align="right">3375</td>
<td align="right">1002</td>
<td align="right">4390</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2000</td>
<td align="right">1</td>
<td align="right">34</td>
<td align="right">37</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">51359</td>
<td align="right">0</td>
<td align="right">2688</td>
<td align="right">9005</td>
<td align="right">304</td>
<td align="right">2044</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2000</td>
<td align="right">2</td>
<td align="right">34</td>
<td align="right">47</td>
<td align="right">46</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8979</td>
<td align="right">34126</td>
<td align="right">500</td>
<td align="right">7208</td>
<td align="right">510</td>
<td align="right">1500</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2000</td>
<td align="right">2</td>
<td align="right">34</td>
<td align="right">39</td>
<td align="right">41</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">47239</td>
<td align="right">36538</td>
<td align="right">2559</td>
<td align="right">2148</td>
<td align="right">656</td>
<td align="right">1226</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">2000</td>
<td align="right">2</td>
<td align="right">34</td>
<td align="right">40</td>
<td align="right">45</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">13756</td>
<td align="right">3803</td>
<td align="right">800</td>
<td align="right">4623</td>
<td align="right">571</td>
<td align="right">1904</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2000</td>
<td align="right">2</td>
<td align="right">34</td>
<td align="right">34</td>
<td align="right">34</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">10499</td>
<td align="right">70023</td>
<td align="right">10287</td>
<td align="right">2124</td>
<td align="right">833</td>
<td align="right">2098</td>
</tr>
</tbody>
</table>
<p>Then, save this dataset as a csv file to your local computer. It is recommended to use <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> to write out the dataset. <code>write.csv</code> tends to pose issues. Also note that you can name the <code>.csv</code> file anything you wish.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taxsim_filename</span> <span class="op">&lt;-</span> <span class="st">'taxsim_dataset.csv'</span>

<span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom_write.html" class="external-link">vroom_write</a></span><span class="op">(</span><span class="va">taxsim_dataset</span>, <span class="va">taxsim_filename</span><span class="op">)</span></code></pre></div>
<p>Now, manually upload the file <code>taxsim_dataset.csv</code> to TAXSIM 32’s server by going to (<a href="https://users.nber.org/~taxsim/taxsim32/" class="external-link uri">https://users.nber.org/~taxsim/taxsim32/</a>), navigating to the following section of the page, and uploading the <code>.csv</code> file:</p>
<p><img src="webimg/taxsim.png" width="75%"></p>
<p>Errors from the manual upload could guide you in solving any data formatting issues.</p>
<p>You can also upload and download the TAXSIM dataset created with <code><a href="../reference/create_dataset_for_taxsim.html">create_dataset_for_taxsim()</a></code> from within R via ftp by using the following commands. Note that <code>taxsim_filename</code> in the code below is the file name to the TAXSIM dataset that we exported in the previous code block.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># create random user id for TAXSIM</span>
<span class="va">user_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">10</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>

<span class="co"># username and password are publically listed, so we're not revealing private information</span>
<span class="va">user_pwd</span> <span class="op">&lt;-</span> <span class="st">'taxsim:02138'</span>

<span class="co"># ftp address to upload file</span>
<span class="va">upload_address</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ftp://"</span>, <span class="va">user_pwd</span>, <span class="st">"@taxsimftp.nber.org/tmp/"</span>, <span class="va">user_id</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>

<span class="co"># ftp address to download file</span>
<span class="va">download_address</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ftp://taxsimftp.nber.org/tmp/"</span>, <span class="va">user_id</span>, <span class="st">".txm32"</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>

<span class="co"># upload file</span>
<span class="fu">RCurl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RCurl/man/ftpUpload.html" class="external-link">ftpUpload</a></span><span class="op">(</span>what <span class="op">=</span> <span class="va">taxsim_filename</span>, to <span class="op">=</span> <span class="va">upload_address</span><span class="op">)</span>

<span class="co"># retrieve results</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">RCurl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RCurl/man/getURL.html" class="external-link">getURL</a></span><span class="op">(</span><span class="va">download_address</span>, userpwd <span class="op">=</span> <span class="va">user_pwd</span><span class="op">)</span>

<span class="co"># read in results</span>
<span class="co"># wrap text in I to properly read in</span>
<span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html" class="external-link">vroom</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://shaneorr.io" class="external-link">Shane Orr</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
